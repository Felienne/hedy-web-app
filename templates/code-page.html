{% extends "level-page.html" %}
{% block levelbody %}
{% if tutorial %}
<div id="tutorial-pop-up" class="z-50 fixed hidden" style="width: 500px; top: 20%; left: 50%; transform: translate(-50%, -50%);">
      <div class="bg-blue-500 border border-black rounded-lg px-8 py-4 text-center">
          <h2 id="tutorial_title" class="text-white"></h2>
          <p id="tutorial_text"></p>
          <button id="tutorial_next_button" class="green-btn mt-4">{{_('next_step_tutorial')}}</button>
      </div>
  </div>
{% endif %}
<div class="pb-4 px-2 pt-2">
    <div class="w-full flex flex-col">
        <div class="ltr:ml-2 rtl:mr-2 flex flex-row">
            <h2 class="border rounded-xl border-gray-700 bg-green-500 text-white px-4 py-1 mt-0 -mb-2" onclick="$('#adventures_container').slideToggle();">Adventures</h2>
        </div>
        <div id="adventures_container" class="w-full border-2 border-green-500 py-2 rounded-lg bg-white">
            {% include "incl-adventure-tabs.html" %}
        </div>
    </div>
    <div>
        {% include "incl-editor-and-output.html" %}
    </div>
    {% if latest %}
      <div class="text-sm font-extralight">
      Latest update: {{latest}}
      </div>
    {% endif %}
</div>
{% endblock %}
{% block scripts %}
  <script src="{{static('/vendor/ace.js')}}" type="text/javascript" charset="utf-8" crossorigin="anonymous"></script>
  <script src="{{static('/vendor/ext-whitespace.js')}}" type="text/javascript" charset="utf-8" crossorigin="anonymous"></script>
  <script src="{{static('/vendor/ext-rtl.js')}}" type="text/javascript" charset="utf-8" crossorigin="anonymous"></script>
  <script src="/client_messages.js" type="text/javascript" crossorigin="anonymous"></script>
  <script>
    window.State = {};
    window.State.lang = "{{ g.lang }}";
    window.State.level = "{{ level }}";
    window.State.level_title = "{{ _('level_title') }}";
    window.State.keyword_language = "{{ g.keyword_lang }}";
    window.State.adventure_name = "{{ adventure_name }}";
    // A copy of window.State.adventure_name but that we don't overwrite when changing tabs. Useful for loading/saving programs when changing tabs.
    window.State.adventure_name_onload = window.State.adventure_name;
    // We load the adventures into the js to have access to their saved programs (if any).
    window.State.adventures = {{ adventures|tojson }};
    {% if loaded_program %}
        window.State.loaded_program = {{ loaded_program|tojson }};
    {% endif %}
    window.State.default_program_name = {{ (_('level_title') + ' ' + level_nr)|tojson }};
  </script>
  <script src="{{static('/js/appbundle.js')}}" type="text/javascript" crossorigin="anonymous"></script>
  <script src="{{static('/vendor/skulpt.min.js')}}" type="text/javascript" crossorigin="anonymous"></script>
  <script src="{{static('/vendor/skulpt-stdlib.js')}}" type="text/javascript" crossorigin="anonymous"></script>
  <script src="{{static('/vendor/jquery.min.js')}}" type="text/javascript" crossorigin="anonymous"></script>
  <!-- If we are in tutorial mode -> hide most features, slowly release them -->
  {% if tutorial %}
    <script>
      $(document).ready(function() {
        hedyApp.startTutorial();
      });
    </script>
  {% endif %}
{% endblock %}
