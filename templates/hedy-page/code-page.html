{% extends "hedy-page/level-page.html" %}
{% block levelbody %}
{% if intro_tutorial or tutorial %}
<div id="tutorial_pop_up" class="z-50 fixed hidden" style="width: 500px; top: 20%; left: 50%; transform: translate(-50%, -50%);">
      <div class="bg-blue-500 border border-black rounded-lg px-8 py-4 text-center">
          <h2 id="tutorial_title" class="text-white"></h2>
          <p id="tutorial_text"></p>
          <button id="tutorial_next_button" class="green-btn mt-4">{{_('next_step_tutorial')}}</button>
      </div>
  </div>
{% endif %}
<div tabindex="0" class="p-4">
    {# When we're NOT in adventure mode but DO have adventures, render them in tabs #}
    {% if raw %}
        {% if get_syntax_language(g.lang) != "en" and (not customizations or 'hide_keyword_switcher' not in customizations['other_settings']) %}
        <div class="flex justify-end mb-4">
            {{ render_partial('htmx-language-switch-button.html', commands=commands) }}
        </div>
        {% endif %}
    {% else %}
        {% include "hedy-page/adventure-tabs.html" %}
    {% endif %}
        {% include "hedy-page/editor-and-output.html" %}
    <!-- progress bar -->
        <div id="progress_bar" data-cy="progress_bar" class="w-full max-w-screen-2xl mx-auto mt-10">
            <div class="flex flex-row w-full">
                <button data-cy="next_adventure" class="blue-btn flex-initial w-fit next-tab ltr:mr-1 rtl:ml-1 justify-self-end mb-1"
                _="on click
                set :next to hedyApp.getNext()
                if :next
                set *display to 'block'
                call :next.click()
                else
                set *display to 'none'
                end
                then set adv to hedyApp.getCurrentAdv()
                put adv into #program_name
                then localStorage.setItem('adventure_dropdown', 'adventure_button_' + adv)">
                        <span class="fa fa-arrow-{% if g.dir == "ltr" %}left{% else %}right{% endif %}"></span>
                        {{_('previous_adventure')}}&nbsp;
                </button>
                <div class="flex-initial"></div>
                <div class="flex-1 mt-5 ml-4 text-center font-medium dark:text-white"><b class="{% if not username %}hidden{% endif %}">{{progress}}% {{_('complete')}}</b></div>                
                <button data-cy="next_adventure" class="blue-btn flex-initial w-fit next-tab ltr:ml-1 rtl:mr-1 justify-self-end mb-1"
                    _="on click
                    set :next to hedyApp.getNext()
                    if :next
                        set *display to 'block'
                        call :next.click()
                    else
                        set *display to 'none'
                    end
                    then set adv to hedyApp.getCurrentAdv()
                    put adv into #program_name
                    then localStorage.setItem('adventure_dropdown', 'adventure_button_' + adv)">
                    {{_('next_adventure')}}&nbsp;
                    <span class="fa fa-arrow-{% if g.dir == "ltr" %}right{% else %}left{% endif %}"></span>
                </button>
            </div>
        <div class="max-w-screen-2xl mr-4 items-center justify-between mx-auto rounded-full h-2.5 bg-gray-300 {% if not username %}hidden{% endif %}">
            <div class="rounded-full h-2.5 bg-blue-800" style="width: {{progress}}%"></div>
        </div>
        </div>
    {% if latest and not raw %}
      <div class="text-sm mt-10 ltr:mr-5 rtl:ml-5 font-extralight">
      Latest update: {{latest}}
      </div>
    {% endif %}
</div>
{% endblock %}
