var hedyApp=(()=>{var N=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports);var H=N(B=>{"use strict";Object.defineProperty(B,"__esModule",{value:!0});B.modal=B.error=B.success=void 0;var ze=function(){function e(){var t=this;$("#modal-confirm-button").on("click",function(){return t.hide()}),$("#modal-no-button").on("click",function(){return t.hide()}),$("#modal-cancel-button").on("click",function(){return t.hide()})}return e.prototype.show=function(){$("#modal-mask").show(),$("#modal-content").show(),window.scrollTo(0,0)},e.prototype.hide=function(){$("#modal-mask").hide(),$("#modal-content").hide(),$("#modal-alert").hide(),$("#modal-prompt").hide(),$("#modal-confirm").hide()},e.prototype.alert=function(t,a,n){var o=this;n===void 0&&(n=""),n!=""?($("#modal-alert-title").html(n),$("#modal-alert-title").removeClass("hidden")):($("#modal-alert-title").html(""),$("#modal-alert-title").addClass("hidden")),$("#modal-alert-text").html(t),this.show(),$("#modal-alert").show(),this._timeout&&(clearTimeout(this._timeout),this._timeout=void 0),a&&(this._timeout=setTimeout(function(){return o.hide()},a))},e.prototype.confirm=function(t,a){var n=this;$("#modal-confirm-text").text(t),this.show(),$("#modal-confirm").show(),$("#modal-yes-button").off("click").on("click",function(){n.hide(),a()})},e.prototype.prompt=function(t,a,n){var o=this;$("#modal-prompt-text").text(t),this.show(),$("#modal-prompt").show(),a&&$("#modal-prompt-input").val(a),$("#modal-ok-button").off("click").on("click",function(){o.hide();var r=$("#modal-prompt-input").val();typeof r=="string"&&n(r)})},e}(),_;B.success={setEditor:function(e){_=e},hide:function(){$("#okbox").hide(),_==null||_.resize()},showWarning:function(e,t){$("#okbox .caption").text(e),$("#okbox .details").text(t),$("#okbox").show(),_==null||_.resize()},show:function(e){$("#okbox .caption").text(e),$("#okbox").show(),_==null||_.resize(),setTimeout(function(){$("#okbox").hide(),_==null||_.resize()},3e3)}};B.error={setEditor:function(e){_=e},hide:function(){$("#errorbox").hide(),$("#warningbox").hide(),_==null||_.resize()},showWarning:function(e,t){$("#warningbox .caption").text(e),$("#warningbox .details").text(t),$("#warningbox").show(),_==null||_.resize()},show:function(e,t){$("#errorbox .caption").text(e),$("#errorbox .details").html(t),$("#errorbox").show(),_==null||_.resize()}};B.modal=new ze});var X=N(Q=>{"use strict";Object.defineProperty(Q,"__esModule",{value:!0});Q.LANG_en=void 0;Q.LANG_en={_PRINT:"print",_ASK:"ask",_ECHO:"echo",_FORWARD:"forward",_TURN:"turn",_IS:"is",_SLEEP:"sleep",_ADD_LIST:"add",_TO_LIST:"to",_REMOVE:"remove",_FROM:"from",_AT:"at",_RANDOM:"random",_IN:"in",_IF:"if",_ELSE:"else",_AND:"and",_REPEAT:"repeat",_TIMES:"times",_FOR:"for",_RANGE:"range",_TO:"to",_STEP:"step",_ELIF:"elif",_INPUT:"input",_OR:"or",_WHILE:"while",_LENGTH:"length"}});var te=N(ee=>{"use strict";Object.defineProperty(ee,"__esModule",{value:!0});ee.LANG_es=void 0;ee.LANG_es={_PRINT:"(?:imprimir|print)",_ASK:"(?:preguntar|ask)",_ECHO:"(?:eco|echo)",_FORWARD:"(?:adelante|forward)",_TURN:"(?:girar|turn)",_IS:"(?:es|is)",_SLEEP:"(?:dormir|sleep)",_ADD_LIST:"(?:a\xF1adir|add)",_TO_LIST:"(?:a|to)",_REMOVE:"(?:borrar|remove)",_FROM:"(?:de|from)",_AT:"(?:en|at)",_RANDOM:"(?:aleatorio|random)",_IN:"(?:en|in)",_IF:"(?:si|if)",_ELSE:"(?:sino|else)",_AND:"(?:y|and)",_REPEAT:"(?:repetir|repeat)",_TIMES:"(?:veces|times)",_FOR:"(?:para|for)",_RANGE:"(?:rango|range)",_TO:"(?:a|to)",_STEP:"(?:paso|step)",_ELIF:"(?:sinosi|elif)",_INPUT:"(?:entrada|input)",_OR:"(?:o|or)",_WHILE:"(?:mientrasw|while)",_LENGTH:"(?:longitud|length)"}});var re=N(ae=>{"use strict";Object.defineProperty(ae,"__esModule",{value:!0});ae.LANG_nl=void 0;ae.LANG_nl={_PRINT:"(?:print|print)",_ASK:"(?:vraag|ask)",_ECHO:"(?:echo|echo)",_FORWARD:"(?:vooruit|forward)",_TURN:"(?:draai|turn)",_IS:"(?:is|is)",_SLEEP:"(?:slaap|sleep)",_ADD_LIST:"(?:voeg|add)",_TO_LIST:"(?:toe aan|to)",_REMOVE:"(?:verwijder|remove)",_FROM:"(?:uit|from)",_AT:"(?:op|at)",_RANDOM:"(?:willekeurig|random)",_IN:"(?:in|in)",_IF:"(?:als|if)",_ELSE:"(?:anders|else)",_AND:"(?:en|and)",_REPEAT:"(?:herhaal|repeat)",_TIMES:"(?:keer|times)",_FOR:"(?:voor|for)",_RANGE:"(?:bereik|range)",_TO:"(?:tot|to)",_STEP:"(?:stap|step)",_ELIF:"(?:alsanders|elif)",_INPUT:"(?:invoer|input)",_OR:"(?:of|or)",_WHILE:"(?:zolang|while)",_LENGTH:"(?:lengte|length)"}});var ce=N(Ee=>{"use strict";Object.defineProperty(Ee,"__esModule",{value:!0});var Se=X(),Ve=te(),We=re();window.State||(window.State={});var Ke=!1,m;if(Ke)switch(window.State.lang){case"nl":m=We.LANG_nl;break;case"es":m=Ve.LANG_es;break;default:m=Se.LANG_en;break}else m=Se.LANG_en;function w(){return{gobble:[{regex:".*",token:"text",next:"start"}],expression_eol:Ye([{regex:"'[^']*'",token:"constant.character"},{regex:m._AT+" "+m._RANDOM,token:"keyword"},{regex:"$",token:"text"}])}}var Ze=[{name:"level1",rules:y(w(),R("gobble"),se(),g("start",{regex:F(m._ECHO),token:"keyword",next:"gobble"}),g("start",{regex:F(m._ASK),token:"keyword",next:"gobble"}))},{name:"level2",rules:y(w(),R("expression_eol"),G("gobble"),S("gobble"),se(),Qe())},{name:"level3",rules:y(w(),se(),R("expression_eol"),G(),S())},{name:"level4",rules:y(w(),R(),G(),S(),le(),x())},{name:"level5",rules:y(w(),R(),G(),S(),le(),x(),ue())},{name:"level6",rules:y(w(),R(),G(),S(),le(),x(),ue(),E())},{name:"level7",rules:y(w(),R(),G(),S(),k(),x(),ue(),E())},{name:"level8",rules:y(w(),R(),G(),S(),k(),x(),E(),xe())},{name:"level9and10",rules:y(w(),R(),G(),S(),k(),x(),E(),be(),xe())},{name:"level11",rules:y(w(),R(),G(),S(),k(),x(),E(),be())},{name:"level12",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level11",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level13",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level14",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level15",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level16",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level17",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level18and19",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level20",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level21",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level22",rules:y(w(),O(),A(),S(),k(),x(),E(),C())},{name:"level23",rules:y(w(),O(),A(),S(),k(),x(),E(),C())}];function Ye(e){for(var t=[],a=0,n=e;a<n.length;a++){var o=n[a];o.regex&&t.push({regex:o.regex+"$",token:o.token,next:"start"}),t.push(o)}return t}function g(e,t){return function(a){var n;Array.isArray(e)||(e=[e]);for(var o=0,r=e;o<r.length;o++){var s=r[o];a[s]||(a[s]=[]),Array.isArray(t)?(n=a[s]).push.apply(n,t):a[s].push(t)}return a}}function V(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(a){for(var n=0,o=e;n<o.length;n++){var r=o[n];a=r(a)}return a}}function y(e){for(var t=[],a=1;a<arguments.length;a++)t[a-1]=arguments[a];return V.apply(void 0,t)(e)}function R(e){return g("start",{regex:F(m._PRINT),token:"keyword",next:e!=null?e:"start"})}function G(e){return g("start",{regex:"(\\w+)( "+m._IS+" "+m._ASK+")",token:["text","keyword"],next:e!=null?e:"expression_eol"})}function S(e){return g("start",{regex:"(\\w+)( "+m._IS+" )",token:["text","keyword"],next:e!=null?e:"expression_eol"})}function O(){return g("start",{regex:"("+m._PRINT+")(\\()",token:["keyword","paren.lparen"],next:"start"})}function se(){return V(g("start",{regex:m._TURN+" (left|right)?",token:"keyword",next:"start"}),g("start",{regex:m._FORWARD,token:"keyword",next:"start"}))}function Qe(){return g("start",{regex:m._SLEEP,token:"keyword",next:"start"})}function A(){return g("start",{regex:"(\\w+)( "+m._IS+" "+m._INPUT+")(\\()",token:["text","keyword","paren.lparen"],next:"start"})}function x(){return V(g("start",{regex:"'[^']*'",token:"constant.character"}),g("start",{regex:m._AT+m._RANDOM,token:"keyword"}),g("start",{regex:"[, ]+",token:"punctuation.operator"}))}function le(){return V(g("start",{regex:F(m._IF),token:"keyword",next:"condition"}),g("start",{regex:F(m._ELSE),token:"keyword"}),g("condition",{regex:F("(("+m._IS+")|("+m._IN+"))"),token:"keyword",next:"start"}))}function k(){return V(g("start",{regex:F(m._IF),token:"keyword",next:"condition"}),g("start",{regex:"\\b"+m._ELSE+"\\b",token:"keyword"}),g("condition",{regex:F("(("+m._IS+")|("+m._IN+"))"),token:"keyword",next:"start"}))}function E(){return g(["start","expression_eol"],[{regex:" \\* ",token:"keyword"},{regex:" \\+ ",token:"keyword"},{regex:" \\- ",token:"keyword"}])}function ue(){return g("start",{regex:"("+m._REPEAT+")( \\w+ )("+m._TIMES+")",token:["keyword","text","keyword"]})}function xe(){return g("start",{regex:"("+m._FOR+" )(\\w+)( "+m._IN+" )(\\w+)",token:["keyword","text","keyword","text"]})}function be(){return g("start",{regex:"("+m._FOR+" )(\\w+)( "+m._IN+" "+m._RANGE+" )(\\w+)( to )(\\w+)",token:["keyword","text","keyword","text","keyword","text"]})}function C(){return g("start",{regex:"("+m._FOR+" )(\\w+)( "+m._IN+" "+m._RANGE+")(\\()([\\s\\w]+)(,)([\\s\\w]+)(\\))",token:["keyword","text","keyword","paren.lparen","text","punctuation.operator","text","paren.rparen"]})}function F(e){return"\\b"+e+" "}function Xe(e){for(var t=0,a=Object.values(e);t<a.length;t++)for(var n=a[t],o=0,r=n;o<r.length;o++){var s=r[o];s.regex&&!s._loosened&&(s.regex=s.regex.replace(/ /g," +"),s._loosened=!0)}return e}if(window.define)for($e=function(e){define("ace/mode/"+e.name,[],function(t,a,n){var o=t("ace/lib/oop"),r=t("ace/mode/text").Mode,s=t("ace/mode/text_highlight_rules").TextHighlightRules;function u(){this.$rules=Xe(e.rules),this.normalizeRules()}o.inherits(u,s);function d(){this.HighlightRules=u}o.inherits(d,r),a.Mode=d})},ne=0,de=Ze;ne<de.length;ne++)Te=de[ne],$e(Te);var $e,Te,ne,de});var fe=N(b=>{"use strict";Object.defineProperty(b,"__esModule",{value:!0});b.reset_level_preferences=b.save_level_settings=b.show_doc_section=b.remove_student=b.join_class=b.delete_class=b.rename_class=b.create_class=void 0;var M=H(),P=W(),q=K();function et(){M.modal.prompt(P.auth.texts.class_name_prompt,"",function(e){if(!e){M.modal.alert(P.auth.texts.class_name_empty);return}$.ajax({type:"POST",url:"/class",data:JSON.stringify({name:e}),contentType:"application/json",dataType:"json"}).done(function(t){t.achievement?(0,q.showAchievements)(t.achievement,!1,"/for-teachers/customize-class/"+t.id):window.location.pathname="/for-teachers/customize-class/"+t.id}).fail(function(t){if(t.responseText=="duplicate"){M.modal.alert(P.auth.texts.class_name_duplicate);return}console.error(t),M.error.show(ErrorMessages.Connection_error,JSON.stringify(t))})})}b.create_class=et;function tt(e){M.modal.prompt(P.auth.texts.class_name_prompt,"",function(t){if(!t){M.modal.alert(P.auth.texts.class_name_empty);return}$.ajax({type:"PUT",url:"/class/"+e,data:JSON.stringify({name:t}),contentType:"application/json",dataType:"json"}).done(function(a){a.achievement?(0,q.showAchievements)(a.achievement,!0,""):location.reload()}).fail(function(a){if(a.responseText=="duplicate"){M.modal.alert(P.auth.texts.class_name_duplicate);return}console.error(a),M.error.show(ErrorMessages.Connection_error,JSON.stringify(a))})})}b.rename_class=tt;function at(e){M.modal.confirm(P.auth.texts.delete_class_prompt,function(){$.ajax({type:"DELETE",url:"/class/"+e,contentType:"application/json",dataType:"json"}).done(function(t){t.achievement?(0,q.showAchievements)(t.achievement,!1,"/for-teachers"):window.location.pathname="/for-teachers"}).fail(function(t){console.error(t),M.error.show(ErrorMessages.Connection_error,JSON.stringify(t))})})}b.delete_class=at;function rt(e,t){if(!P.auth.profile)return M.modal.confirm(P.auth.texts.join_prompt,function(){localStorage.setItem("hedy-join",JSON.stringify({id:e,name:t})),window.location.pathname="/login"});$.ajax({type:"POST",url:"/class/join",contentType:"application/json",data:JSON.stringify({id:e,name:t}),dataType:"json"}).done(function(a){a.achievement?(0,q.showAchievements)(a.achievement,!1,"/programs"):window.location.pathname="/programs"}).fail(function(a){console.error(a),M.error.show(ErrorMessages.Connection_error,JSON.stringify(a))})}b.join_class=rt;function nt(e,t,a){var n;a?n=P.auth.texts.self_removal_prompt:n=P.auth.texts.remove_student_prompt,M.modal.confirm(n,function(){$.ajax({type:"DELETE",url:"/class/"+e+"/student/"+t,contentType:"application/json",dataType:"json"}).done(function(o){o.achievement?(0,q.showAchievements)(o.achievement,!0,""):location.reload()}).fail(function(o){console.error(o),M.error.show(ErrorMessages.Connection_error,JSON.stringify(o))})})}b.remove_student=nt;function ot(e){$(".section-button").each(function(){$(this).hasClass("blue-btn")&&($(this).removeClass("blue-btn"),$(this).addClass("green-btn"))}),$("#section-"+e).is(":visible")?($("#button-"+e).removeClass("blue-btn"),$("#button-"+e).addClass("green-btn"),$(".section").hide()):($("#button-"+e).removeClass("green-btn"),$("#button-"+e).addClass("blue-btn"),$(".section").hide(),$("#section-"+e).toggle())}b.show_doc_section=ot;function it(e,t){var a=[];$("#adventures_overview li").each(function(){$(this).is(":visible")&&$(this).find(":input").prop("checked")&&a.push(this.getAttribute("id"))});var n=!!$("#hide_level"+t).prop("checked"),o=!!$("#hide_level"+(t-1)).prop("checked"),r=!!$("#example_programs"+t).prop("checked"),s=!!$("#hide_level"+(t-1)).prop("checked");$.ajax({type:"PUT",url:"/customize-class/"+e,data:JSON.stringify({adventures:a,example_programs:r,hide_level:n,hide_prev_level:s,hide_next_level:o,level:t}),contentType:"application/json",dataType:"json"}).done(function(u){u.achievement?(0,q.showAchievements)(u.achievement,!0,""):location.reload()}).fail(function(u){console.error(u),M.error.show(ErrorMessages.Connection_error,JSON.stringify(u))})}b.save_level_settings=it;function st(e){$("#adventures_overview li").each(function(){$(this).is(":visible")&&$(this).find(":input").prop("checked",!0)}),$("#example_programs"+e).prop("checked",!0),$("#hide_level"+e).prop("checked",!1)}b.reset_level_preferences=st});var W=N(i=>{"use strict";var lt=i&&i.__awaiter||function(e,t,a,n){function o(r){return r instanceof a?r:new a(function(s){s(r)})}return new(a||(a=Promise))(function(r,s){function u(f){try{l(n.next(f))}catch(h){s(h)}}function d(f){try{l(n.throw(f))}catch(h){s(h)}}function l(f){f.done?r(f.value):o(f.value).then(u,d)}l((n=n.apply(e,t||[])).next())})},ut=i&&i.__generator||function(e,t){var a={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},n,o,r,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(l){return function(f){return d([l,f])}}function d(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=l[0]&2?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[l[0]&2,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(l[0]===6||l[0]===2)){a=0;continue}if(l[0]===3&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(l[0]===6&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(f){l=[6,f],o=0}finally{n=r=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(i,"__esModule",{value:!0});i.auth=void 0;var J=H(),dt=fe(),ct=K(),ke={AF:"Afghanistan",AX:"\xC5land Islands",AL:"Albania",DZ:"Algeria",AS:"American Samoa",AD:"Andorra",AO:"Angola",AI:"Anguilla",AQ:"Antarctica",AG:"Antigua and Barbuda",AR:"Argentina",AM:"Armenia",AW:"Aruba",AU:"Australia",AT:"Austria",AZ:"Azerbaijan",BS:"Bahamas",BH:"Bahrain",BD:"Bangladesh",BB:"Barbados",BY:"Belarus",BE:"Belgium",BZ:"Belize",BJ:"Benin",BM:"Bermuda",BT:"Bhutan",BO:"Bolivia, Plurinational State of",BQ:"Bonaire, Sint Eustatius and Saba",BA:"Bosnia and Herzegovina",BW:"Botswana",BV:"Bouvet Island",BR:"Brazil",IO:"British Indian Ocean Territory",BN:"Brunei Darussalam",BG:"Bulgaria",BF:"Burkina Faso",BI:"Burundi",KH:"Cambodia",CM:"Cameroon",CA:"Canada",CV:"Cape Verde",KY:"Cayman Islands",CF:"Central African Republic",TD:"Chad",CL:"Chile",CN:"China",CX:"Christmas Island",CC:"Cocos (Keeling) Islands",CO:"Colombia",KM:"Comoros",CG:"Congo",CD:"Congo, the Democratic Republic of the",CK:"Cook Islands",CR:"Costa Rica",CI:"C\xF4te d'Ivoire",HR:"Croatia",CU:"Cuba",CW:"Cura\xE7ao",CY:"Cyprus",CZ:"Czech Republic",DK:"Denmark",DJ:"Djibouti",DM:"Dominica",DO:"Dominican Republic",EC:"Ecuador",EG:"Egypt",SV:"El Salvador",GQ:"Equatorial Guinea",ER:"Eritrea",EE:"Estonia",ET:"Ethiopia",FK:"Falkland Islands (Malvinas)",FO:"Faroe Islands",FJ:"Fiji",FI:"Finland",FR:"France",GF:"French Guiana",PF:"French Polynesia",TF:"French Southern Territories",GA:"Gabon",GM:"Gambia",GE:"Georgia",DE:"Germany",GH:"Ghana",GI:"Gibraltar",GR:"Greece",GL:"Greenland",GD:"Grenada",GP:"Guadeloupe",GU:"Guam",GT:"Guatemala",GG:"Guernsey",GN:"Guinea",GW:"Guinea-Bissau",GY:"Guyana",HT:"Haiti",HM:"Heard Island and McDonald Islands",VA:"Holy See (Vatican City State)",HN:"Honduras",HK:"Hong Kong",HU:"Hungary",IS:"Iceland",IN:"India",ID:"Indonesia",IR:"Iran, Islamic Republic of",IQ:"Iraq",IE:"Ireland",IM:"Isle of Man",IL:"Israel",IT:"Italy",JM:"Jamaica",JP:"Japan",JE:"Jersey",JO:"Jordan",KZ:"Kazakhstan",KE:"Kenya",KI:"Kiribati",KP:"Korea, Democratic People's Republic of",KR:"Korea, Republic of",KW:"Kuwait",KG:"Kyrgyzstan",LA:"Lao People's Democratic Republic",LV:"Latvia",LB:"Lebanon",LS:"Lesotho",LR:"Liberia",LY:"Libya",LI:"Liechtenstein",LT:"Lithuania",LU:"Luxembourg",MO:"Macao",MK:"Macedonia, the Former Yugoslav Republic of",MG:"Madagascar",MW:"Malawi",MY:"Malaysia",MV:"Maldives",ML:"Mali",MT:"Malta",MH:"Marshall Islands",MQ:"Martinique",MR:"Mauritania",MU:"Mauritius",YT:"Mayotte",MX:"Mexico",FM:"Micronesia, Federated States of",MD:"Moldova, Republic of",MC:"Monaco",MN:"Mongolia",ME:"Montenegro",MS:"Montserrat",MA:"Morocco",MZ:"Mozambique",MM:"Myanmar",NA:"Namibia",NR:"Nauru",NP:"Nepal",NL:"Netherlands",NC:"New Caledonia",NZ:"New Zealand",NI:"Nicaragua",NE:"Niger",NG:"Nigeria",NU:"Niue",NF:"Norfolk Island",MP:"Northern Mariana Islands",NO:"Norway",OM:"Oman",PK:"Pakistan",PW:"Palau",PS:"Palestine, State of",PA:"Panama",PG:"Papua New Guinea",PY:"Paraguay",PE:"Peru",PH:"Philippines",PN:"Pitcairn",PL:"Poland",PT:"Portugal",PR:"Puerto Rico",QA:"Qatar",RE:"R\xE9union",RO:"Romania",RU:"Russian Federation",RW:"Rwanda",BL:"Saint Barth\xE9lemy",SH:"Saint Helena, Ascension and Tristan da Cunha",KN:"Saint Kitts and Nevis",LC:"Saint Lucia",MF:"Saint Martin (French part)",PM:"Saint Pierre and Miquelon",VC:"Saint Vincent and the Grenadines",WS:"Samoa",SM:"San Marino",ST:"Sao Tome and Principe",SA:"Saudi Arabia",SN:"Senegal",RS:"Serbia",SC:"Seychelles",SL:"Sierra Leone",SG:"Singapore",SX:"Sint Maarten (Dutch part)",SK:"Slovakia",SI:"Slovenia",SB:"Solomon Islands",SO:"Somalia",ZA:"South Africa",GS:"South Georgia and the South Sandwich Islands",SS:"South Sudan",ES:"Spain",LK:"Sri Lanka",SD:"Sudan",SR:"Suriname",SJ:"Svalbard and Jan Mayen",SZ:"Swaziland",SE:"Sweden",CH:"Switzerland",SY:"Syrian Arab Republic",TW:"Taiwan, Province of China",TJ:"Tajikistan",TZ:"Tanzania, United Republic of",TH:"Thailand",TL:"Timor-Leste",TG:"Togo",TK:"Tokelau",TO:"Tonga",TT:"Trinidad and Tobago",TN:"Tunisia",TR:"Turkey",TM:"Turkmenistan",TC:"Turks and Caicos Islands",TV:"Tuvalu",UG:"Uganda",UA:"Ukraine",AE:"United Arab Emirates",GB:"United Kingdom",US:"United States",UM:"United States Minor Outlying Islands",UY:"Uruguay",UZ:"Uzbekistan",VU:"Vanuatu",VE:"Venezuela, Bolivarian Republic of",VN:"Viet Nam",VG:"Virgin Islands, British",VI:"Virgin Islands, U.S.",WF:"Wallis and Futuna",EH:"Western Sahara",YE:"Yemen",ZM:"Zambia",ZW:"Zimbabwe"};if(!window.AuthMessages)throw new Error('On a page where you load this JavaScript, you must also load the "client_messages.js" script');i.auth={texts:AuthMessages,profile:void 0,reset:void 0,entityify:function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/`/g,"&#96;")},emailRegex:/^(([a-zA-Z0-9_+\.\-]+)@([\da-zA-Z\.\-]+)\.([a-zA-Z\.]{2,6})\s*)$/,redirect:function(e){e="/"+e,window.location.pathname=e},logout:function(){$.ajax({type:"POST",url:"/auth/logout"}).done(function(){i.auth.redirect("login")})},destroy:function(){J.modal.confirm(i.auth.texts.are_you_sure,function(){$.ajax({type:"POST",url:"/auth/destroy"}).done(function(){i.auth.redirect("")})})},error:function(e,t,a){$(a||"#error").html(e),$(a||"#error").css("display","block"),t&&$("#"+t).css("border","solid 1px red")},clear_error:function(e){$(e||"#error").html(""),$(e||"#error").css("display","none"),$("form *").css("border","")},success:function(e,t){$("#error").css("display","none"),$(t||"#success").html(e),$(t||"#success").css("display","block")},submit:function(e){var t,a,n,o,r={};if($("form.js-validated-form *").map(function(u,d){d.id&&(r[d.id]=d.value)}),e==="signup"){if(!r.username)return i.auth.error(i.auth.texts.please_username,"username");if(r.username=r.username.trim(),r.username.length<3)return i.auth.error(i.auth.texts.username_three,"username");if(r.username.match(/:|@/))return i.auth.error(i.auth.texts.username_special,"username");if(!((t=r.email)===null||t===void 0?void 0:t.match(i.auth.emailRegex)))return i.auth.error(i.auth.texts.valid_email,"email");if(r.email!==r.mail_repeat)return i.auth.error(i.auth.texts.repeat_match_email,"mail_repeat");if(!r.language)return i.auth.error(i.auth.texts.please_language,"language");if(!r.password)return i.auth.error(i.auth.texts.please_password,"password");if(r.password.length<6)return i.auth.error(i.auth.texts.password_six,"password");if(r.password!==r.password_repeat)return i.auth.error(i.auth.texts.repeat_match_password,"password_repeat");if(r.birth_year&&!Ae(r.birth_year))return i.auth.error(i.auth.texts.valid_year+new Date().getFullYear(),"birth_year");var s={username:r.username,email:r.email,password:r.password,language:r.language,birth_year:r.birth_year?parseInt(r.birth_year):void 0,country:r.country?r.country:void 0,gender:r.gender?r.gender:void 0,subscribe:$("#subscribe").prop("checked"),is_teacher:$("#is_teacher").prop("checked"),prog_experience:$("input[name=has_experience]:checked").val(),experience_languages:$("#languages").is(":visible")?$("input[name=languages]").filter(":checked").map(function(u,d){return $(d).val()}).get():void 0};$.ajax({type:"POST",url:"/auth/signup",data:JSON.stringify(s),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.success(i.auth.texts.signup_success),i.auth.profile={session_expires_at:Date.now()+1e3*60*60*24},Ie()}).fail(function(u){if(u.status>=500)return i.auth.error(i.auth.texts.server_error);var d=u.responseText||"";d.match("email")?i.auth.error(i.auth.texts.exists_email):d.match("username")?i.auth.error(i.auth.texts.exists_username):i.auth.error(i.auth.texts.ajax_error)})}if(e==="login"){if(!r.username)return i.auth.error(i.auth.texts.please_username_email,"username");if(!r.password)return i.auth.error(i.auth.texts.please_password,"password");i.auth.clear_error(),$.ajax({type:"POST",url:"/auth/login",data:JSON.stringify({username:r.username,password:r.password}),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.profile={session_expires_at:Date.now()+1e3*60*60*24},Ie()}).fail(function(u){var d;if(u.status>=500)return i.auth.error(i.auth.texts.server_error);u.status===403?(i.auth.error(i.auth.texts.invalid_username_password+" "+i.auth.texts.no_account+` &nbsp;<button class="green-btn" onclick="auth.redirect ('signup')">`+i.auth.texts.create_account+"</button>"),$("#create-account").hide(),localStorage.setItem("hedy-login-username",(d=r.username)!==null&&d!==void 0?d:"")):i.auth.error(i.auth.texts.ajax_error)})}if(e==="profile"){if(!((a=r.email)!==null&&a!==void 0?a:"").match(i.auth.emailRegex))return i.auth.error(i.auth.texts.valid_email,"email");if(r.birth_year&&!Ae(r.birth_year))return i.auth.error(i.auth.texts.valid_year+new Date().getFullYear(),"birth_year");var s={email:r.email,birth_year:r.birth_year?parseInt(r.birth_year):void 0,country:r.country?r.country:void 0,gender:r.gender?r.gender:void 0,language:r.language,prog_experience:$("input[name=has_experience]:checked").val(),experience_languages:$("#languages").is(":visible")?$("input[name=languages]").filter(":checked").map(function(d,l){return $(l).val()}).get():void 0};console.log(s),i.auth.clear_error(),$.ajax({type:"POST",url:"/profile",data:JSON.stringify(s),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.success(i.auth.texts.profile_updated),setTimeout(function(){location.reload()},500)}).fail(function(d){if(d.status>=500)return i.auth.error(i.auth.texts.server_error);i.auth.error(i.auth.texts.ajax_error+" "+d.responseText)})}if(e==="change_password"){if(!r.password)return i.auth.error(i.auth.texts.please_password,"password","#error-password");if(r.password.length<6)return i.auth.error(i.auth.texts.password_six,"password","#error-password");if(r.password!==r.password_repeat)return i.auth.error(i.auth.texts.repeat_match,"password_repeat","#error-password");var s={old_password:r.old_password,new_password:r.password};i.auth.clear_error("#error-password"),$.ajax({type:"POST",url:"/auth/change_password",data:JSON.stringify(s),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.success(i.auth.texts.password_updated,"#success-password"),$("#old_password").val(""),$("#password").val(""),$("#password_repeat").val("")}).fail(function(d){if(d.status>=500)return i.auth.error(i.auth.texts.server_error);d.status===403?i.auth.error(i.auth.texts.invalid_password,null,"#error-password"):i.auth.error(i.auth.texts.ajax_error,null,"#error-password")})}if(e==="recover"){if(!r.username)return i.auth.error(i.auth.texts.please_username,"username");var s={username:r.username};i.auth.clear_error(),$.ajax({type:"POST",url:"/auth/recover",data:JSON.stringify(s),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.success(i.auth.texts.sent_password_recovery),$("#username").val("")}).fail(function(d){if(d.status>=500)return i.auth.error(i.auth.texts.server_error);d.status===403?i.auth.error(i.auth.texts.invalid_username):i.auth.error(i.auth.texts.ajax_error)})}if(e==="reset"){if(!r.password)return i.auth.error(i.auth.texts.please_password,"password");if(r.password.length<6)return i.auth.error(i.auth.texts.password_six,"password");if(r.password!==r.password_repeat)return i.auth.error(i.auth.texts.repeat_match,"password_repeat");var s={username:(n=i.auth.reset)===null||n===void 0?void 0:n.username,token:(o=i.auth.reset)===null||o===void 0?void 0:o.token,password:r.password};i.auth.clear_error(),$.ajax({type:"POST",url:"/auth/reset",data:JSON.stringify(s),contentType:"application/json; charset=utf-8"}).done(function(){i.auth.success(i.auth.texts.password_resetted),$("#password").val(""),$("#password_repeat").val(""),delete i.auth.reset,i.auth.redirect("login")}).fail(function(d){if(d.status>=500)return i.auth.error(i.auth.texts.server_error);d.status===403?i.auth.error(i.auth.texts.invalid_reset_link):i.auth.error(i.auth.texts.ajax_error)})}},markAsTeacher:function(e,t){$.ajax({type:"POST",url:"/admin/markAsTeacher",data:JSON.stringify({username:e,is_teacher:t}),contentType:"application/json; charset=utf-8"}).done(function(){J.modal.alert(["User",e,"successfully",t?"marked":"unmarked","as teacher"].join(" "),4e3),location.reload()}).fail(function(a){console.log(a),J.modal.alert(["Error when",t?"marking":"unmarking","user",e,"as teacher"].join(" "))})},changeUserEmail:function(e,t){J.modal.prompt("Please enter the corrected email",t,function(a){if(a!==t){if(!a.match(i.auth.emailRegex))return J.modal.alert("Please enter a valid email.");$.ajax({type:"POST",url:"/admin/changeUserEmail",data:JSON.stringify({username:e,email:a}),contentType:"application/json; charset=utf-8"}).done(function(){J.modal.alert(["Successfully changed the email for User",e,"to",a].join(" ")),location.reload()}).fail(function(n){console.log(n),J.modal.alert(["Error when changing the email for User",e].join(" "))})}})}};$("#country")&&(he=$("#country").html(),Object.keys(ke).map(function(e){he+='<option value="'+e+'">'+ke[e]+"</option>"}),$("#country").html(he));var he;$(".auth input").get().map(function(e){e.addEventListener("input",function(){return i.auth.clear_error()})});$.ajax({type:"GET",url:"/profile"}).done(function(e){["/signup","/login"].indexOf(window.location.pathname)!==-1&&i.auth.redirect("my-profile"),i.auth.profile=e});window.location.pathname==="/reset"&&(Me=window.location.search.slice(1).split("&"),Z={},Me.map(function(e){var t=e.split("=");Z[t[0]]=decodeURIComponent(t[1])}),!Z.username||!Z.token?i.auth.redirect("recover"):i.auth.reset=Z);var Me,Z;window.location.pathname==="/signup"&&(Y=localStorage.getItem("hedy-login-username"),Y&&(localStorage.removeItem("hedy-login-username"),Y.match("@")?$("#email").val(Y):$("#username").val(Y)),me=localStorage.getItem("hedy-save-redirect"),me&&me.includes("invite")&&$("#is_teacher_div").hide());var Y,me;$("#email, #mail_repeat").on("cut copy paste",function(e){return e.preventDefault(),!1});function Ie(){return lt(this,void 0,void 0,function(){var e,t,a,n,o,r;return ut(this,function(s){switch(s.label){case 0:return e=localStorage.getItem("hedy-first-save"),t=e?JSON.parse(e):void 0,t?[4,(0,ct.saveitP)(t[0],t[1],t[2],t[3])]:[3,2];case 1:if(s.sent(),localStorage.removeItem("hedy-first-save"),a=Oe(),a)return[2,i.auth.redirect(a)];s.label=2;case 2:return n=localStorage.getItem("hedy-join"),o=n?JSON.parse(n):void 0,o?(localStorage.removeItem("hedy-join"),[2,(0,dt.join_class)(o.link,o.name)]):(r=Oe(),r?[2,i.auth.redirect(r)]:(i.auth.redirect("programs"),[2]))}})})}function Oe(){var e=localStorage.getItem("hedy-save-redirect");return e&&localStorage.removeItem("hedy-save-redirect"),e}function Ae(e){var t=parseInt(e);return!(!t||t<1900||t>new Date().getFullYear())}});var K=N(c=>{"use strict";var ft=c&&c.__awaiter||function(e,t,a,n){function o(r){return r instanceof a?r:new a(function(s){s(r)})}return new(a||(a=Promise))(function(r,s){function u(f){try{l(n.next(f))}catch(h){s(h)}}function d(f){try{l(n.throw(f))}catch(h){s(h)}}function l(f){f.done?r(f.value):o(f.value).then(u,d)}l((n=n.apply(e,t||[])).next())})},ht=c&&c.__generator||function(e,t){var a={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},n,o,r,s;return s={next:u(0),throw:u(1),return:u(2)},typeof Symbol=="function"&&(s[Symbol.iterator]=function(){return this}),s;function u(l){return function(f){return d([l,f])}}function d(l){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,o&&(r=l[0]&2?o.return:l[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,l[1])).done)return r;switch(o=0,r&&(l=[l[0]&2,r.value]),l[0]){case 0:case 1:r=l;break;case 4:return a.label++,{value:l[1],done:!1};case 5:a.label++,o=l[1],l=[0];continue;case 7:l=a.ops.pop(),a.trys.pop();continue;default:if(r=a.trys,!(r=r.length>0&&r[r.length-1])&&(l[0]===6||l[0]===2)){a=0;continue}if(l[0]===3&&(!r||l[1]>r[0]&&l[1]<r[3])){a.label=l[1];break}if(l[0]===6&&a.label<r[1]){a.label=r[1],r=l;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(l);break}r[2]&&a.ops.pop(),a.trys.pop();continue}l=t.call(e,a)}catch(f){l=[6,f],o=0}finally{n=r=0}if(l[0]&5)throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}};Object.defineProperty(c,"__esModule",{value:!0});c.change_language=c.load_profile=c.toggle_developers_mode=c.modalStepOne=c.ScrollOutputToBottom=c.confetti_cannon=c.get_trimmed_code=c.load_quiz=c.prompt_unsaved=c.copy_to_clipboard=c.submit_program=c.delete_program=c.share_program=c.viewProgramLink=c.saveitP=c.saveit=c.tryPaletteCode=c.fix_code=c.showAchievements=c.pushAchievement=c.runit=c.theModalEditor=c.theGlobalEditor=void 0;X();te();re();ce();var p=H(),v=W();(function(){window.State||(window.State={}),o($("#editor"));for(var e=function(s){$(s).addClass("text-lg rounded");var u=r(s,!0);if(u.setOptions({maxLines:1/0}),u.setOptions({minLines:2}),u.setValue(u.getValue().replace(/\n+$/,""),-1),$(s).hasClass("no-copy-button")){if($(s).attr("id")){var l=String($(s).attr("id")),f=pe(parseInt(l));u.session.setMode(f)}}else{var d=$("<div>").css({position:"absolute",top:5,right:5,width:"auto"}).appendTo(s);$("<button>").attr("title",UiMessages.try_button).css({fontFamily:"sans-serif"}).addClass("green-btn").text("\u21E5").appendTo(d).click(function(){c.theGlobalEditor===null||c.theGlobalEditor===void 0||c.theGlobalEditor.setValue(u.getValue()+`
`)})}},t=0,a=$(".turn-pre-into-ace pre").get();t<a.length;t++){var n=a[t];e(n)}function o(s){if(!!s.length){var u=r(s.get(0),s.data("readonly"));c.theGlobalEditor=u,p.error.setEditor(u),window.Range=ace.require("ace/range").Range;var d=window.sessionStorage;if(d){var l=s.data("lskey"),f=s.data("loaded-program"),h=d.getItem(l);f!=="True"&&h&&u.setValue(h,1),u.on("blur",function(L){d.setItem(l,u.getValue())}),u.on("change",function(){$("#inline-modal").is(":visible")&&$("#inline-modal").hide(),window.State.disable_run=!1,$("#runit").css("background-color",""),window.State.unsaved_changes=!0,Ce(u)})}window.onbeforeunload=function(){if(window.State.unsaved_changes&&!window.State.no_unload_prompt)return v.auth.texts.unsaved_changes};var T;return window.addEventListener("keydown",function(L){var D=L.keyCode;if(D===18){T=!0;return}if(D===13&&T){if(!window.State.level||!window.State.lang)throw new Error("Oh no");ve(window.State.level,window.State.lang,function(){$("#output").focus()})}D===37&&document.activeElement===document.getElementById("output")&&(u.focus(),u.navigateFileEnd())}),window.addEventListener("keyup",function(L){var D=L.keyCode;if(D===18){T=!1;return}}),u}}function r(s,u){var d=ace.edit(s);d.setTheme("ace/theme/monokai"),u&&d.setOptions({readOnly:!0,showGutter:!1,showPrintMargin:!1,highlightActiveLine:!1});var l=1;if(l==1&&window.State.level){var f=pe(parseInt(window.State.level));d.session.setMode(f)}return d}})();function pe(e){var t={"9":"ace/mode/level9and10","10":"ace/mode/level9and10","18":"ace/mode/level18and19","19":"ace/mode/level18and19"};return t[e]||"ace/mode/level"+e}function ge(){return!v.auth.profile||v.auth.profile.session_expires_at>Date.now()?!1:(location.reload(),!0)}function Ce(e){e.session.clearAnnotations();for(var t in e.session.getMarkers(!1))e.session.removeMarker(t)}function ve(e,t,a){if(window.State.disable_run)return p.modal.alert(v.auth.texts.answer_question);if(!ge()){var n=$("#output");n.empty(),$("#turtlecanvas").empty(),p.error.hide(),p.success.hide();try{e=e.toString();var o=c.theGlobalEditor,r=oe();Ce(o),Re(),console.log(`Original program:
`,r),$.ajax({type:"POST",url:"/parse",data:JSON.stringify({level:e,code:r,lang:t,read_aloud:!!$("#speak_dropdown").val(),adventure_name:window.State.adventure_name}),contentType:"application/json",dataType:"json"}).done(function(s){if(console.log("Response",s),s.Warning&&(_e(e,t),Ne(e),p.error.showWarning(ErrorMessages.Transpile_warning,s.Warning)),s.achievements&&U(s.achievements,!1,""),s.Error){p.error.show(ErrorMessages.Transpile_error,s.Error),s.Location&&s.Location[0]!="?"&&(_e(e,t),pt(o,s.Location[0],s.Location[1]));return}bt(s.Code,s.has_turtle,s.Warning,a).catch(function(u){console.log(u),p.error.show(ErrorMessages.Execute_error,u.message),xt(e,r,u.message)})}).fail(function(s){console.error(s),s.readyState<4?p.error.show(ErrorMessages.Connection_error,ErrorMessages.CheckInternet):p.error.show(ErrorMessages.Other_error,ErrorMessages.ServerError)})}catch(s){console.error(s),p.error.show(ErrorMessages.Other_error,s.message)}}}c.runit=ve;function Ne(e){var t=parseInt(e);if(t<=2){var a=document.getElementById("repair_button");a.style.visibility="visible",a.onclick=function(n){n.preventDefault(),Be(t)}}}function z(e){$.ajax({type:"POST",url:"/achievements",data:JSON.stringify({achievement:e}),contentType:"application/json",dataType:"json"}).done(function(t){t.achievements&&(console.log(t.achievements),U(t.achievements,!1,""))})}c.pushAchievement=z;function U(e,t,a){Pe(e,0),t&&setTimeout(function(){location.reload()},e.length*6e3),a&&setTimeout(function(){window.location.pathname=a},e.length*6e3)}c.showAchievements=U;function Pe(e,t){return ft(this,void 0,void 0,function(){return ht(this,function(a){switch(a.label){case 0:return[4,mt(e[t])];case 1:return a.sent(),t<e.length-1?[4,Pe(e,t+1)]:[3,3];case 2:a.sent(),a.label=3;case 3:return[2]}})})}function mt(e){return new Promise(function(t){$("#achievement_reached_title").text('"'+e[0]+'"'),$("#achievement_reached_text").text(e[1]),$("#achievement_pop-up").fadeIn(1e3,function(){setTimeout(function(){$("#achievement_pop-up").fadeOut(1e3)},4e3)}),setTimeout(function(){t()},6e3)})}function Re(){var e=document.getElementById("repair_button");e.style.visibility="hidden"}function _e(e,t){if(window.State.disable_run)return p.modal.alert(v.auth.texts.answer_question);if(!ge())try{e=e.toString();var a=oe();$.ajax({type:"POST",url:"/fix-code",data:JSON.stringify({level:e,code:a,lang:t,read_aloud:!!$("#speak_dropdown").val(),adventure_name:window.State.adventure_name}),contentType:"application/json",dataType:"json"}).done(function(n){n.FixedCode&&(sessionStorage.setItem("fixed_level_{lvl}__code".replace("{lvl}",e),n.FixedCode),Ne(e))}).fail(function(n){console.error(n),n.readyState<4?p.error.show(ErrorMessages.Connection_error,ErrorMessages.CheckInternet):p.error.show(ErrorMessages.Other_error,ErrorMessages.ServerError)})}catch(n){console.error(n),p.error.show(ErrorMessages.Other_error,n.message)}}c.fix_code=_e;function pt(e,t,a,n){if(n===void 0&&(n=1),e.session.setAnnotations([{row:t-1,column:(a!=null?a:1)-1,text:"",type:"error"}]),a===void 0){e.session.addMarker(new ace.Range(t-1,1,t-1,2),"editor-error","fullLine",!1);return}e.session.addMarker(new ace.Range(t-1,a-1,t-1,a-1+n),"editor-error","text",!1)}function gt(e){if(v.auth.profile)if(window.State.examples_left>0)window.State.examples_left=window.State.examples_left-1;else{$("#commands-window").hide(),$("#toggle-button").hide(),p.modal.alert(v.auth.texts.examples_used);return}var t=ace.edit("editor"),a=1;t.setValue(e+`
`,a),window.State.unsaved_changes=!1}c.tryPaletteCode=gt;function je(e,t,a,n,o){window.State.unsaved_changes=!1;var r=window.State.adventure_name;Array.isArray(e)&&(r=e[1],e=e[0]),$.ajax({type:"POST",url:"/programs",data:JSON.stringify({level:e,lang:t,name:a,code:n,adventure_name:r}),contentType:"application/json",dataType:"json"}).done(function(s){var u;if(o)return s.Error?o(s):o(null,s);p.modal.alert(v.auth.texts.save_success_detail,4e3),s.achievements&&U(s.achievements,!1,""),$("#program_name").val(s.name),(u=window.State.adventures)===null||u===void 0||u.map(function(d){d.short_name===(r||"level")&&(d.loaded_program={name:s.name,code:n})})}).fail(function(s){console.error(s),p.error.show(ErrorMessages.Connection_error,JSON.stringify(s)),s.status===403&&(localStorage.setItem("hedy-first-save",JSON.stringify([r?[e,r]:e,t,a,n])),localStorage.setItem("hedy-save-redirect","hedy"),window.location.pathname="/login")})}function we(e,t,a,n,o){if(p.error.hide(),p.success.hide(),!ge())try{if(!v.auth.profile)return p.modal.confirm(v.auth.texts.save_prompt,function(){window.State&&window.State.adventure_name&&!Array.isArray(e)&&(e=[e,window.State.adventure_name]),localStorage.setItem("hedy-first-save",JSON.stringify([e,t,a,n])),window.location.pathname="/login"});$.ajax({type:"POST",url:"/programs/duplicate-check",data:JSON.stringify({name:a}),contentType:"application/json",dataType:"json"}).done(function(r){r.duplicate?p.modal.confirm(v.auth.texts.overwrite_warning,function(){je(e,t,a,n,o),z("double_check")}):je(e,t,a,n,o)})}catch(r){console.error(r),p.error.show(ErrorMessages.Other_error,r.message)}}c.saveit=we;function vt(e,t,a,n){return new Promise(function(o,r){we(e,t,a,n,function(s,u){s?r(s):o(u)})})}c.saveitP=vt;function Le(e){return window.location.origin+"/hedy/"+e+"/view"}c.viewProgramLink=Le;function _t(e,t,a,n,o){if(!v.auth.profile)return p.modal.alert(v.auth.texts.must_be_logged);var r=function(d){$.ajax({type:"POST",url:"/programs/share",data:JSON.stringify({id:d,public:n}),contentType:"application/json",dataType:"json"}).done(function(l){if(l.achievement&&U(l.achievement,!1,""),p.modal.alert(n?v.auth.texts.share_success_detail:v.auth.texts.unshare_success_detail,5e3),n){var f=document.getElementById("modal-alert-buttons");f.insertAdjacentHTML("afterbegin",["<button ",'id="modal-copy-share-link"',` onclick="hedyApp.copy_to_clipboard('`,Le(d),`'); this.remove(); $('#modal-confirm-button').show();"`,' class="green-btn block m-4 w-40 pb-4 pt-4">',v.auth.texts.copy_link_to_share,"</button>"].join("")),$("#modal-confirm-button").hide(),setTimeout(function(){$("#modal-copy-share-link")&&$("#modal-copy-share-link").remove(),$("#modal-confirm-button").show()},5e3)}o&&setTimeout(function(){location.reload()},n?5e3:1e3)}).fail(function(l){console.error(l),p.error.show(ErrorMessages.Connection_error,JSON.stringify(l))})};if(a!==!0)return r(a);var s=""+$("#program_name").val(),u=oe();return we(e,t,s,u,function(d,l){if(d&&d.Warning)return p.error.showWarning(ErrorMessages.Transpile_warning,d.Warning);if(d&&d.Error)return p.error.show(ErrorMessages.Transpile_error,d.Error);r(l.id)})}c.share_program=_t;function wt(e){p.modal.confirm(v.auth.texts.delete_confirm,function(){$.ajax({type:"POST",url:"/programs/delete",data:JSON.stringify({id:e}),contentType:"application/json",dataType:"json"}).done(function(t){t.achievement?U(t.achievement,!0,""):location.reload()}).fail(function(t){console.error(t),p.error.show(ErrorMessages.Connection_error,JSON.stringify(t))})})}c.delete_program=wt;function yt(e,t){if(!v.auth.profile)return p.modal.alert(v.auth.texts.must_be_logged);if(console.log(t),!t)return p.modal.alert(v.auth.texts.must_be_shared);$.ajax({type:"POST",url:"/programs/submit",data:JSON.stringify({id:e}),contentType:"application/json",dataType:"json"}).done(function(a){a.achievements?U(a.achievements,!0,""):location.reload()})}c.submit_program=yt;function St(e,t){var a,n,o=document.createElement("textarea");o.value=e,o.setAttribute("readonly",""),o.style.position="absolute",o.style.left="-9999px",document.body.appendChild(o);var r=document.getSelection(),s=r&&r.rangeCount>0?r.getRangeAt(0):void 0;o.select(),document.execCommand("copy"),document.body.removeChild(o),s&&((a=document.getSelection())===null||a===void 0||a.removeAllRanges(),(n=document.getSelection())===null||n===void 0||n.addRange(s)),t||p.modal.alert(v.auth.texts.copy_clipboard,4e3)}c.copy_to_clipboard=St;function xt(e,t,a){$.ajax({type:"POST",url:"/report_error",data:JSON.stringify({level:e,code:t,page:window.location.href,client_error:a}),contentType:"application/json",dataType:"json"})}window.onerror=function(t,a,n,o,r){$.ajax({type:"POST",url:"/client_exception",data:JSON.stringify({message:t,source:a,line_number:n,column_number:o,error:r,url:window.location.href,user_agent:navigator.userAgent}),contentType:"application/json",dataType:"json"})};function bt(e,t,a,n){window.State.programsInExecution||(window.State.programsInExecution=0),window.State.programsInExecution++;var o=$("#output");o.empty(),Sk.pre="output";var r=Sk.TurtleGraphics||(Sk.TurtleGraphics={});return r.target="turtlecanvas",$("#adventures").is(":hidden")?(r.height=600,r.worldHeight=600):(r.height=300,r.worldHeight=300),r.width=400,r.worldWidth=400,t?$("#turtlecanvas").show():$("#turtlecanvas").empty(),Sk.configure({output:d,read:l,inputfun:f,inputfunTakesPrompt:!0,__future__:Sk.python3,timeoutMsg:function(){return z("hedy_hacking"),ErrorMessages.Program_too_long},execLimit:function(){return t?2e4:3e3}()}),Sk.misceval.asyncToPromise(function(){return Sk.importMainWithBody("<stdin>",!1,e,!0)}).then(function(h){console.log("Program executed"),window.State.programsInExecution===1&&$("#output").is(":empty")&&$("#turtlecanvas").is(":empty")&&(z("error_or_empty"),p.error.showWarning(ErrorMessages.Transpile_warning,ErrorMessages.Empty_output)),window.State.programsInExecution--,a||It(),n&&n()}).catch(function(h){console.log(h);var T=s(h)||JSON.stringify(h);throw new Error(T)});function s(h){var T=h.args&&h.args.v&&h.args.v[0]&&h.args.v[0].v;return T}function u(h,T){$("<span>").text(h).css({color:T}).appendTo(o)}function d(h){window.State.programsInExecution>1||(u(h,"white"),Ge(h))}function l(h){if(Sk.builtinFiles===void 0||Sk.builtinFiles.files[h]===void 0)throw"File not found: '"+h+"'";return Sk.builtinFiles.files[h]}function f(h){return Sk.execStart=new Date(new Date().getTime()+1e3*60*60*24*365),$("#turtlecanvas").hide(),new Promise(function(T){window.State.disable_run=!0,$("#runit").css("background-color","gray");var L=$('#inline-modal input[type="text"]');$("#inline-modal .caption").text(h),L.val(""),L.attr("placeholder",h),Ge(h),setTimeout(function(){L.focus()},0),$("#inline-modal form").one("submit",function(D){return window.State.disable_run=!1,$("#runit").css("background-color",""),D.preventDefault(),$("#inline-modal").hide(),t&&$("#turtlecanvas").show(),Sk.execStart=new Date,setTimeout(function(){T(L.val()),$("#output").focus()},0),!1}),$("#inline-modal").show()})}}function Ge(e){var t=$("#speak_dropdown").val();if(!!t){var a=window.speechSynthesis.getVoices().filter(function(o){return o.voiceURI===t})[0];if(a){var n=new SpeechSynthesisUtterance(e);n.voice=a,n.rate=.9,speechSynthesis.speak(n)}z("make_some_noise")}}(function(){if(!window.speechSynthesis||!window.State.lang)return;var e=0,t=setInterval(function(){var n;e+=1;var o=a((n=window.State.lang)!==null&&n!==void 0?n:"");if(o.length>0){for(var r=0,s=o;r<s.length;r++){var u=s[r];$("#speak_dropdown").append($("<option>").attr("value",u.voiceURI).text("\u{1F4E3} "+u.name))}$("#speak_container").show(),clearInterval(t)}e>=20&&clearInterval(t)},100);function a(n){var o=n.match(/^([a-z]+)/i);if(!o)return[];var r=o[1];return window.speechSynthesis?window.speechSynthesis.getVoices().filter(function(s){return s.lang.startsWith(r)}):[]}})();function $t(e){if(window.State.no_unload_prompt=!0,!window.State.unsaved_changes||!v.auth.profile)return e();p.modal.confirm(v.auth.texts.unsaved_changes,e)}c.prompt_unsaved=$t;function Tt(e,t){$('*[data-tabtarget="end"]').html('<iframe id="quiz-iframe" class="w-full" title="Quiz" src="/quiz/start/'+e+"?lang="+t+'"></iframe>')}c.load_quiz=Tt;function oe(){try{var e=ace.require("ace/ext/whitespace");e.trimTrailingSpace(c.theGlobalEditor.session,!0)}catch(t){console.error(t)}return c.theGlobalEditor===null||c.theGlobalEditor===void 0?void 0:c.theGlobalEditor.getValue()}c.get_trimmed_code=oe;function Et(){var e=document.getElementById("confetti");if(e){e.classList.remove("hidden");var t=new JSConfetti({canvas:e});setTimeout(function(){e.classList.add("hidden")},3e3);var a=$("#adventures"),n=$(a).find(".tab-selected").attr("data-tab"),o=["turtle","rock","haunted","restaurant","fortune","songs","dice"];if(o.includes(n)){var r=kt(n!=null?n:"");t.addConfetti({emojis:r,emojiSize:45,confettiNumber:100})}else t.addConfetti();var s=document.getElementById("confetti-button");s&&s.classList.add("hidden")}}c.confetti_cannon=Et;function kt(e){var t=Array.from(ErrorMessages[e]);return t!=null?t:[["\u{1F308}"],["\u26A1\uFE0F"],["\u{1F4A5}"],["\u2728"],["\u{1F4AB}"]]}function Mt(){return $("#output").animate({scrollTop:$(document).height()},"slow"),!1}c.ScrollOutputToBottom=Mt;function Be(e){Ot(e);var t=$("#modal-editor");Ct(t)}c.modalStepOne=Be;function It(){Re();var e=ErrorMessages.Transpile_success,t=Math.floor(Math.random()*e.length);p.success.show(e[t])}function Ot(e){var t=`<div id='modal-editor' data-lskey="level_{level}__code" class="w-full flex-1 text-lg rounded" style='height:200px; width:50vw;'></div>`.replace("{level}",e.toString()),a=ErrorMessages.Program_repair;p.modal.alert(t,0,a)}function At(e,t){var a=ace.edit(e);a.setTheme("ace/theme/monokai"),t&&a.setOptions({readOnly:!0,showGutter:!1,showPrintMargin:!1,highlightActiveLine:!1});var n=1;if(n==1&&window.State.level){var o=pe(parseInt(window.State.level));a.session.setMode(o)}return a}function Ct(e){var t,a;if(!!e.length){var n=At(e.get(0),!0);c.theModalEditor=n,p.error.setEditor(n),setTimeout(function(){},2e3),window.Range=ace.require("ace/range").Range;var o=window.sessionStorage;if(o){var r=e.data("lskey"),s=0,u="";if(o.getItem("fixed_{lvl}".replace("{lvl}",r))){u=(t=o.getItem("fixed_{lvl}".replace("{lvl}",r)))!==null&&t!==void 0?t:"";for(var d="",l=0;l<u.length+1;l++)setTimeout(function(){n.setValue(d,s),d+=u[s],s++},150*l)}else u=(a=o.getItem("warning_{lvl}".replace("{lvl}",r)))!==null&&a!==void 0?a:"",n.setValue(u)}window.onbeforeunload=function(){if(window.State.unsaved_changes&&!window.State.no_unload_prompt)return v.auth.texts.unsaved_changes};var f;return window.addEventListener("keydown",function(h){var T=h.keyCode;if(T===18){f=!0;return}if(T===13&&f){if(!window.State.level||!window.State.lang)throw new Error("Oh no");ve(window.State.level,window.State.lang,function(){$("#output").focus()})}T===37&&document.activeElement===document.getElementById("output")&&(n.focus(),n.navigateFileEnd())}),window.addEventListener("keyup",function(h){var T=h.keyCode;if(T===18){f=!1;return}}),n}}function Nt(e){$("#developers_toggle").is(":checked")?($("#commands-window-total").hide(),$("#adventures").hide(),z("lets_focus")):(e&&$("#commands-window-total").show(),$("#adventures").show()),$("#adventures").is(":hidden")?($("#editor-area").removeClass("mt-5"),$("#code_editor").css("height",36+"em"),$("#code_output").css("height",36+"em")):($("#editor-area").addClass("mt-5"),$("#code_editor").height("22rem"),$("#code_output").height("22rem"))}c.toggle_developers_mode=Nt;function Pt(e,t,a,n,o){$("#profile").toggle(),$("#profile").is(":visible")&&($("#username").html(e),$("#email").val(t),$("#birth_year").val(a),$("#gender").val(n),$("#country").val(o))}c.load_profile=Pt;function Rt(e){$.ajax({type:"POST",url:"/change_language",data:JSON.stringify({lang:e}),contentType:"application/json",dataType:"json"}).done(function(t){t.succes&&location.reload()}).fail(function(t){console.error(t)})}c.change_language=Rt});var De=N(Fe=>{"use strict";Object.defineProperty(Fe,"__esModule",{value:!0});var jt=H(),Lt=W(),I=K();$(function(){function e(){$("#warningbox").hide(),$("#errorbox").hide(),$("#okbox").hide(),$("#output").empty(),$("#turtlecanvas").empty(),window.State.unsaved_changes=!1}function t(n){var o,r,s=$('*[data-tab="'+n+'"]'),u=s.siblings("*[data-tab]"),d=$('*[data-tabtarget="'+n+'"]'),l=d.siblings("*[data-tabtarget]");u.removeClass("tab-selected"),s.addClass("tab-selected"),l.addClass("hidden"),d.removeClass("hidden");var f={};if((o=window.State.adventures)===null||o===void 0||o.map(function(h){f[h.short_name]=h}),document.getElementById("repair_button").style.visibility="hidden",e(),n==="end"){$("#adventures-tab").css("height",""),$("#adventures-tab").css("max-height","100%"),$("#level-header input").hide(),$("#editor-area").hide();return}$("#adventures-tab").css("max-height","20em"),$("#level-header input").show(),$("#editor-area").show(),window.State.loaded_program&&(window.State.adventure_name_onload||"level")===n?($("#program_name").val(window.State.loaded_program.name),I.theGlobalEditor===null||I.theGlobalEditor===void 0||I.theGlobalEditor.setValue(window.State.loaded_program.code)):((r=f[n])===null||r===void 0?void 0:r.loaded_program)?($("#program_name").val(f[n].loaded_program.name),I.theGlobalEditor===null||I.theGlobalEditor===void 0||I.theGlobalEditor.setValue(f[n].loaded_program.code)):n==="level"&&window.State.default_program_name&&window.State.default_program?($("#program_name").val(window.State.default_program_name),I.theGlobalEditor===null||I.theGlobalEditor===void 0||I.theGlobalEditor.setValue(window.State.default_program)):($("#program_name").val(f[n].default_save_name+" - "+window.State.level_title+" "+window.State.level),I.theGlobalEditor===null||I.theGlobalEditor===void 0||I.theGlobalEditor.setValue(f[n].start_code)),window.State.adventure_name=n==="level"?void 0:n,I.theGlobalEditor===null||I.theGlobalEditor===void 0||I.theGlobalEditor.clearSelection(),window.State.unsaved_changes=!1}if($("*[data-tab]").click(function(n){var o=$(n.target),r=o.data("tab");n.preventDefault(),window.State.unsaved_changes?jt.modal.confirm(Lt.auth.texts.unsaved_changes,function(){return t(r)}):t(r);var s=r!=="level"?r:"";window.history&&window.history.replaceState(null,"","#"+s)}),window.State&&window.State.adventure_name)t(window.State.adventure_name);else if(window.location.hash){var a=window.location.hash.replace(/^#/,"");a&&t(a)}})});var qe=N(()=>{"use strict";function Gt(e){var t=80,a=e.split(`
`),n=a.map(function(o){return Math.floor(o.length/t)});return Bt(n)+a.length}function Bt(e){for(var t=0,a=0,n=e;a<n.length;a++){var o=n[a];t+=o}return t}function Je(e){var t=Math.max(1,Gt($(e).val())),a=t*25+4;$(e).height()<a&&$(e).css({height:a+"px"})}var ye=!0,Ue=$(".translated-input").filter(function(e,t){return t.textContent!==null&&t.textContent.length>0&&$(t).parent().parent().find(".original-text")[0].textContent!==t.textContent});$("#show-hide-missing-translations").click(function(){ye?(Ue.each(function(e,t){$(t).parent().parent().hide()}),$("tr.bg-purple-200").hide(),ye=!1,$(this)[0].innerText="Show all translations"):(Ue.each(function(e,t){$(t).parent().parent().show()}),$("tr.bg-purple-200").show(),ye=!0,$(this)[0].innerText="Show only missing translations")});$("textarea").each(function(e,t){return Je(t)}).on("input",function(e){var t=$(e.target);t.hasClass("touched")||(t.addClass("touched"),t.attr("name",t.data("name")),Ft(t.closest("form"))),Je(t)});var He=new Map;function Ft(e){var t=e.data("file"),a=He.get(t);if(!a){var n=$('button[data-file="'+t+'"]');a={button:n,changes:0},He.set(t,a)}a.changes+=1,a.button.text(t+" ("+a.changes+")")}$("button[data-file]").click(function(e){var t=$(e.target).data("file"),a=$('form[data-file="'+t+'"]');a.submit()})});var Jt=N(j=>{"use strict";var Dt=j&&j.__createBinding||(Object.create?function(e,t,a,n){n===void 0&&(n=a),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[a]}})}:function(e,t,a,n){n===void 0&&(n=a),e[n]=t[a]}),ie=j&&j.__exportStar||function(e,t){for(var a in e)a!=="default"&&!Object.prototype.hasOwnProperty.call(t,a)&&Dt(t,e,a)};Object.defineProperty(j,"__esModule",{value:!0});ie(H(),j);ie(K(),j);ie(W(),j);X();re();te();ce();De();qe();ie(fe(),j)});return Jt();})();
//# sourceMappingURL=appbundle.js.map
